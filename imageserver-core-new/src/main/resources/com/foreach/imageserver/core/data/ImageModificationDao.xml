<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.foreach.imageserver.core.data.ImageModificationDao">

    <sql id="columns">
		IM.applicationId as application_id,
		IM.imageId as image_id,
        IM.resolutionId as resolution_id,
        IM.densityWidth as density_width,
        IM.densityHeight as density_height,
        IM.cropX as crop_x,
        IM.cropY as crop_y,
        IM.cropWidth as crop_width,
        IM.cropHeight as crop_height,
        IM.cropSourceWidth as crop_source_width,
        IM.cropSourceHeight as crop_source_height
	</sql>

    <resultMap id="imageModificationMap" type="ImageModification">
        <id property="applicationId" column="application_id"/>
        <id property="imageId" column="image_id"/>
        <id property="resolutionId" column="resolution_id"/>
        <result property="density.width" column="density_width"/>
        <result property="density.height" column="density_height"/>
        <result property="crop.x" column="crop_x"/>
        <result property="crop.y" column="crop_y"/>
        <result property="crop.width" column="crop_width"/>
        <result property="crop.height" column="crop_height"/>
        <result property="crop.sourceWidth" column="crop_source_width"/>
        <result property="crop.sourceHeight" column="crop_source_height"/>
    </resultMap>

    <select id="getById" parameterType="map" resultMap="imageModificationMap">
        SELECT
        <include refid="columns"/>
        FROM IMAGE_MODIFICATION IM
        WHERE IM.applicationId = #{applicationId} AND IM.imageId = #{imageId} AND IM.resolutionId = #{imageResolutionId}
    </select>

    <insert id="insert" parameterType="ImageModification">
        INSERT INTO IMAGE_MODIFICATION (
          applicationId,
          imageId,
          resolutionId,
          densityWidth,
          densityHeight,
          cropX,
          cropY,
          cropWidth,
          cropHeight,
          cropSourceWidth,
          cropSourceHeight
        ) VALUES (
          #{applicationId},
          #{imageId},
          #{resolutionId},
          #{density.width},
          #{density.height},
          #{crop.x},
          #{crop.y},
          #{crop.width},
          #{crop.height},
          #{crop.sourceWidth},
          #{crop.sourceHeight}
        )
    </insert>

</mapper>
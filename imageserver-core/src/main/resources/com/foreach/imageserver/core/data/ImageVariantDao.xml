<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.foreach.imageserver.core.data.ImageVariantDao">

    <resultMap id="imageVariantMap" type="com.foreach.imageserver.core.business.ImageVariant">
        <id property="imageId" column="imageid"/>
        <result property="width" column="width"/>
        <result property="height" column="height"/>
        <result property="output" column="outputtype"
                typeHandler="com.foreach.imageserver.core.data.handlers.ImageTypeHandler"/>
        <result property="density.width" column="densityx"/>
        <result property="density.height" column="densityy"/>
        <result property="stretch" column="stretch"/>
        <result property="keepAspect" column="keepaspect"/>
    </resultMap>

    <select id="getVariantsForApplication" parameterType="int" resultMap="imageVariantMap">
		SELECT *
		FROM imagevariant
		WHERE applicationid = #{value}
		ORDER BY width ASC, height ASC
	</select>

    <insert id="insertVariant" parameterType="map">
        INSERT INTO imagevariant (
            applicationid, width, height, outputtype, densityx, densityy, stretch, keepaspect
        ) VALUES (
            #{applicationId},
            #{variant.width},
            #{variant.height},
            #{variant.output.id},
            #{variant.density.width},
            #{variant.density.height},
            #{variant.stretch},
            #{variant.keepAspect}
        )
    </insert>

</mapper>
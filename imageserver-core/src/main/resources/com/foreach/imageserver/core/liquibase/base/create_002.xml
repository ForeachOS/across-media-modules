<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
		xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
    <property name="now" value="GETDATE()" dbms="mssql"/>
    <property name="now" value="NOW" dbms="hsqldb"/>
	<changeSet id="201307311437" author="arne">
		<comment>Creates imagemodification table</comment>
		<createTable tableName="imagemodification">
			<column name="imageid" type="int">
				<constraints nullable="false" references="image(id)" foreignKeyName="fk_imageid_image_id"/>
			</column>
			<column name="width" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="height" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="outputtype" type="varchar(10)">
				<constraints references="imagetype(id)" foreignKeyName="fk_outputtype_imagetype_id"/>
			</column>
			<column name="cropx" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="cropy" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="cropwidth" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="cropheight" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="cropsourcewidth" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="cropsourceheight" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="densityx" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="densityy" type="int" defaultValueNumeric="0">
				<constraints nullable="false"/>
			</column>
			<column name="stretch" type="boolean" defaultValueBoolean="false">
				<constraints nullable="false"/>
			</column>
			<column name="keepaspect" type="boolean" defaultValueBoolean="false">
				<constraints nullable="false"/>
			</column>
			<column name="created" type="datetime" defaultValueComputed="${now}">
				<constraints nullable="false"/>
			</column>
			<column name="updated" type="datetime"/>
		</createTable>
        <addUniqueConstraint
                columnNames="imageid, width, height, outputtype, densityx, densityy, stretch, keepaspect"
                constraintName="unique_modification" deferrable="false" disabled="false" initiallyDeferred="false"
                tableName="imagemodification"/>
	</changeSet>

</databaseChangeLog>